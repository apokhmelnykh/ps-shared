# Перенос групп безопасности между доменами

## Параметры запуска скрипта
`dirRootPath` - стартовая директория откуда начинать сканирование, обязательный параметр  
`groupNameLike` - фильтр по имени группы, параметр задан по умолчанию  
`dirScanLevel` - глубина обхода, параметр задан по умолчанию  
`dstDomainController` - Имя котнроллера домена в целевом домене, параметр задан по умолчанию  
`dstOU` - DN путь в целевом домене, где будут созданы группы, обязательный параметр  
`csvPath` - путь к файлу в формате csv, в него сохраняем группы, которые будут созданы в целевом домене, параметр задан по умолчанию  
`srcDomain` - NetBIOS имя исходного домена  
`dstDomain` - NetBIOS имя целевого домена  
`migrateGroups` - если задан, то скрипт создаст группы в целевом домене  
`updateACL` - если задан, то скрипт обновит ACL в исходном домене

## Пример запуска
```
.\Create-GroupsFromACL.ps1 `
    -dirRootPath C:\Shared\ `
    -groupNameLike "*FA*" `
    -dstDomainController addc01.xyz.local `
    -dstOU "OU=FileAccess,OU=ADDS,DC=xyz,DC=local" `
    -srcDomain ABC `
    -dstDomain XYZ
```

## Как работает скрипт
### Block1. 
Запустите скрипт от пользователя домена из которого осуществляем перенос групп.  
Скрипт рекурсивно находит директории начиная с директории переданной в параметре `dirRootPath`.  
Далее из полученных директорий извлекаются группы безопасности с учетом фильтра по имени группы и глубины обхода.  
Из исходного домена запрашивается информация для поля "описание" групп безопасноти.  
Формируется файл в формате csv, который содержит имена и описания групп безопасности из исходного домена.  

### Block2.
В целевом домене создаются группы безопасности полученные на предыдущем шаге. Группы создаются в OU переданном в параметре `dstOU`.

### Block3.
В исходном домене изменяем ACL для директории `dirRootPath` и вложенных в нее директорий.
